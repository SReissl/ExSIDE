initnames=c("D_h","M","p_h","LL","k","p","V_h","c_d","alpha1","alpha2","H_dn","u","W","theta","lev_f","lev_ft","yfc","Pr_f","div_f","sav_ft","r_dav","TAA_h","porthgb","gb_h","g_des","Tax","gb_cb","gb","r_gb","pi_q","r_cbd","r_cbl","buff_h","r_IB","LL_sup","M_sup","YD_e","YD","rr_he","rr_h","lev_fe","c","u_e","u_ecb","pi_e","Rshock","y","YD_tax","D_f","bb","UIC","iLL","K")
inits<-array(data=NA, dim=c(1,length(initnames)),dimnames = list(NULL,initnames))
parnames=c("u_n","alpha1L","alpha1U","alpha2L","alpha2U","sigmampc1","sigmampc2","rho0","rho1","rho2","rho3","eta","beta1","theta1","kappa","alpha","chi_M","chi_LL","zeta_LL","zeta_M","epsilond1","lambdah10","lambdah11","lambdah12","mu1","omega1","omega2","omega3","phiu","phipi","psi_ad","sigmaIB","delta_k","LTV","h","lev_ft1","tau","pit","CARt0","LCRt","g0","r0","r1","E_f","randdis","randdef","sdev_dis","sdev_def","AR_dis","iota1","iota2","sdev_R","CBnoise","AR_def","gby","AR_r","Hommes","psi_tf1","psi_tf2","psi_aa","memory","intensity","epsilond2","M_step","LL_step","W_n","gamma1","gamma2","CC_def","est1","est2")
params<-array(data=NA, dim=c(1,length(parnames)),dimnames = list(NULL,parnames))
nB=12
bankinitnames=c("r_LLb","r_Mb","r_db","D_hb","LL_b","M_b","a_b","r_b","IBL_b","IBA_b","LL_supb","LL_db","M_supb","M_db","v_bb","v_bbe","pr_b","div_b","v_bbe1","v_bbe2","v_bbe3","v_bbe4","D_fb","bb_b","clear_b","defrateM","defrateLL","markup_M","markup_LL")
bankinits<-array(data=NA,dim=c(nB,length(bankinitnames)),dimnames=list(NULL,bankinitnames))
init=function(init=inits,param=params,bankinit=bankinits){
  nB=12
  ifelse(nB==12,shares<-c(0.13,0.11,0.11,0.09,0.1,0.08,0.07,0.07,0.06,0.06,0.06,0.06),ifelse(nB==8,shares<-c(0.2,0.15,0.15,0.125,0.125,0.08,0.08,0.09),shares<-c(1/3,1/4,1/4,1/6)))
  alpha1U=0.85
  alpha1L=0.75
  alpha2U=0.055
  alpha2L=0.045
  alpha1=round((alpha1U+alpha1L)/2,1)
  alpha2=round((alpha2U+alpha2L)/2,2)
  LTV=0.75
  psi_ad=0.5
  k=300000
  h=475000
  u=0.8
  u_n=u
  u_e=u
  u_ecb=u
  pit=0
  pi_q=pit
  pi_e=pit
  iy=0.165
  gy=0.19
  delta_k=0.002385
  delta_ka=-((1-delta_k)^48-1)
  i_d=delta_k*k
  i_des=0
  gamma1=0.001
  gamma2=0.0009
  kappa=(u*iy)/delta_ka
  y_a=(u*k)/kappa
  y=y_a/48
  y_e=y
  yfc=k/kappa
  g0=gy*y_a
  g_des=g0
  g=g_des/48
  c_desa=(y_a-i_d*48-g_des)
  c_des=c_desa/48
  c_d=c_des
  c=c_des
  p=1
  p_h=p
  alpha=24
  N_d=(y_a/48)/alpha
  Y_a=y_a*p
  K=k*p
  theta1=0.5
  theta=theta1
  lev_f=0.5
  LL=lev_f*K
  lev_ft=lev_f
  YD_a=c_desa*p
  YD=YD_a/48
  V_h=((1-alpha1)*YD_a)/alpha2
  r0=0.04
  r1=0.01
  r_cbd=r0
  r_cbl=r0+r1
  r_IB=(r_cbd+r_cbl)/2
  epsilond1=-0.025
  epsilond2=0.01
  r_db=r_IB+epsilond1
  markup_M=1.2
  markup_LL=1.2
  LL_step=0.005
  M_step=0.005
  beta1=8.8
  eta=0.08
  MH=0.75
  M=MH*p_h*h
  CARt0=0.1
  LCRt=1
  CARt=CARt0
  omega1=0.5
  omega2=1 
  V_bb=CARt0*(omega1*M+omega2*LL)
  v_bb<-c(V_bb*shares)
  v_bbe<-v_bb
  gby=0.4
  gb=gby*y_a
  gb_cb=1/4*gb
  gb_h=gb-gb_cb
  R=gb_cb
  bb=V_bb
  D=LL+M+R-V_bb
  r_b<-c(R*shares)
  E_f=(K-LL)
  D_h=M+V_h-p_h*h-bb-gb_h-E_f
  D_f=D-D_h
  omega3=R/(D*LCRt)
  buff_h=D_h
  bb_b<-c(bb*shares)
  D_hb<-c(D_h*shares)
  D_fb<-c(D_f*shares)
  H_dn=h*p_h*eta/48
  M_sup=LTV*H_dn
  H_dna=H_dn*48
  chi_M=0.05
  zeta_M=(M_sup*48/M-chi_M)/MH
  LL_d=p*i_d
  LL_sup=LL_d
  zeta_LL=omega2/omega1*zeta_M*MH/lev_f
  chi_LL=-(zeta_LL*lev_f*LL-LL_sup*48)/LL
  r_LLb=(r_IB+zeta_LL*lev_f)*markup_LL
  r_Mb=(r_IB+zeta_M*MH)*markup_M
  UIC=(r_LLb*(LL-zeta_LL*lev_f*LL/48)/48-r_db*D_f/48)/(y_a/48)
  UC=p/(1+theta1)-UIC
  WB=UC*(y_a/48)
  W=WB/N_d
  W_n=W
  Pr_f=c*p+g*p+p*i_d+r_db*D_f/48-WB-r_LLb*(LL-zeta_LL*lev_f*LL/48)/48+zeta_LL*lev_f*LL/48-delta_k*k
  iLL=r_LLb*(LL-zeta_LL*lev_f*LL/48)/48
  div_f=Pr_f
  bal_f=c+g+r_db*D_f/48-WB-r_LLb*(LL-zeta_LL*lev_f*LL/48)/48-div_f
  rho0=0.425*H_dna
  rho2=0.575*H_dna/LTV
  rho1=0.0003
  rho3=600
  TAA_h=D_h+gb_h
  porthgb=gb_h/TAA_h
  lambdah11=4
  lambdah12=lambdah11
  lambdah10=0.25
  r_gb=(gb_h/TAA_h-lambdah10+lambdah12*r_db)/lambdah11
  Pr_b=(r_Mb*(M-zeta_M*MH*M/48)+r_LLb*(LL-zeta_LL*lev_f*LL/48)+r_cbd*R-r_db*D_h-r_db*D_f-zeta_M*MH*M-zeta_LL*lev_f*LL)/48
  Div_b=Pr_b
  pr_b<-c(Pr_b*shares)
  div_b=pr_b
  rr_h=r_db*D_h/(TAA_h+p_h*h)+r_gb*gb_h/(TAA_h+p_h*h)
  PCB=(r_gb*gb_cb-r_cbd*R)/48
  Tax=g*p+(r_gb*gb)/48-PCB
  PSBR=g*p+(r_gb*gb)/48-PCB-Tax
  tau=Tax/(WB+Div_b+(r_gb*gb_h)/48+div_f+r_db*D_h/48)
  sigmampc1=12
  sigmampc2=sigmampc1*rr_h
  sigmaIB=0.01
  mu1=0
  #mu1=5
  mu2=1
  IBA_b=0
  IBL_b=0
  a_b=0
  randdis=1
  randdef=1
  iota1=0.25
  iota2=0.25
  CARb=CARt0
  CARb_e=CARt0
  CAR=CARt0
  YD_e=YD
  v_bbe=v_bb
  rr_he=rr_h
  lev_fe=lev_f
  gb_d=gb_h
  AR_dis=0.9
  AR_r=0.9
  AR_def=0.92
  D_b<-c((D_h+D_f)*shares)
  M_supb<-c(M_sup*shares)
  LL_b<-c(LL*shares)
  M_b<-c((M)*shares)
  iD_h=r_db*D_h/48
  iD_f=r_db*D_f/48
  theta2=0
  LL_supb<-c(LL_sup*shares)
  LL_db=LL_supb
  M_db=M_supb
  r_dav=r_db
  phiu=0
  phipi=0.25
  sdev_dis=0.0005
  sdev_def=1.9
  sav_ft=LL+p*i_d-zeta_LL*lev_f*LL/48-chi_LL*LL/48-lev_ft*(K-p*delta_k*k+p*i_d)
  sdev_R=R/100
  Rshock=0
  defrateM=zeta_M*MH
  defrateLL=zeta_LL*lev_f
  CBnoise=1
  Hommes=0
  psi_tf1=0.75
  psi_tf2=1.3
  psi_aa=0.5
  memory=0.7
  intensity=5
  v_bbe1=v_bbe
  v_bbe2=v_bbe
  v_bbe3=v_bbe
  v_bbe4=v_bbe
  lev_ft1=lev_ft
  YD_tax=WB+r_db*D_h/48+div_f+r_gb*gb_h/48+Div_b
  V_f=K+D_f-LL-E_f
  clear_b=0
  CC_def=0.5
  est1=0
  est2=0
  
  init[1,1]<-D_h
  init[1,2]<-M
  init[1,3]<-p_h
  init[1,4]<-LL
  init[1,5]<-k
  init[1,6]<-p
  init[1,7]<-V_h
  init[1,8]<-c_d
  init[1,9]<-alpha1
  init[1,10]<-alpha2
  init[1,11]<-H_dn
  init[1,12]<-u
  init[1,13]<-W
  init[1,14]<-theta
  init[1,15]<-lev_f
  init[1,16]<-lev_ft
  init[1,17]<-yfc
  init[1,18]<-Pr_f
  init[1,19]<-div_f
  init[1,20]<-sav_ft
  init[1,21]<-r_dav
  init[1,22]<-TAA_h
  init[1,23]<-porthgb
  init[1,24]<-gb_h
  init[1,25]<-g_des
  init[1,26]<-Tax
  init[1,27]<-gb_cb
  init[1,28]<-gb
  init[1,29]<-r_gb
  init[1,30]<-pi_q
  init[1,31]<-r_cbd
  init[1,32]<-r_cbl
  init[1,33]<-buff_h
  init[1,34]<-r_IB
  init[1,35]<-LL_sup
  init[1,36]<-M_sup
  init[1,37]<-YD_e
  init[1,38]<-YD
  init[1,39]<-rr_he
  init[1,40]<-rr_h
  init[1,41]<-lev_fe
  init[1,42]<-c
  init[1,43]<-u_e
  init[1,44]<-u_ecb
  init[1,45]<-pi_e
  init[1,46]<-Rshock
  init[1,47]<-y
  init[1,48]<-YD_tax
  init[1,49]<-D_f
  init[1,50]<-bb
  init[1,51]<-UIC
  init[1,52]<-iLL
  init[1,53]<-k
  
  bankinit[,1]<-r_LLb
  bankinit[,2]<-r_Mb
  bankinit[,3]<-r_db
  bankinit[,4]<-D_hb
  bankinit[,5]<-LL_b
  bankinit[,6]<-M_b
  bankinit[,7]<-a_b
  bankinit[,8]<-r_b
  bankinit[,9]<-IBL_b
  bankinit[,10]<-IBA_b
  bankinit[,11]<-LL_supb
  bankinit[,12]<-LL_db
  bankinit[,13]<-M_supb
  bankinit[,14]<-M_db
  bankinit[,15]<-v_bb
  bankinit[,16]<-v_bbe
  bankinit[,17]<-pr_b
  bankinit[,18]<-div_b
  bankinit[,19]<-v_bbe1
  bankinit[,20]<-v_bbe2
  bankinit[,21]<-v_bbe3
  bankinit[,22]<-v_bbe4
  bankinit[,23]<-D_fb
  bankinit[,24]<-bb_b
  bankinit[,25]<-clear_b
  bankinit[,26]<-defrateM
  bankinit[,27]<-defrateLL
  bankinit[,28]<-markup_M
  bankinit[,29]<-markup_LL
  
  param[1,1]<-u_n
  param[1,2]<-alpha1L
  param[1,3]<-alpha1U
  param[1,4]<-alpha2L
  param[1,5]<-alpha2U
  param[1,6]<-sigmampc1
  param[1,7]<-sigmampc2
  param[1,8]<-rho0
  param[1,9]<-rho1
  param[1,10]<-rho2
  param[1,11]<-rho3
  param[1,12]<-eta
  param[1,13]<-beta1
  param[1,14]<-theta1
  param[1,15]<-kappa
  param[1,16]<-alpha
  param[1,17]<-chi_M
  param[1,18]<-chi_LL
  param[1,19]<-zeta_LL
  param[1,20]<-zeta_M
  param[1,21]<-epsilond1
  param[1,22]<-lambdah10
  param[1,23]<-lambdah11
  param[1,24]<-lambdah12
  param[1,25]<-mu1
  param[1,26]<-omega1
  param[1,27]<-omega2
  param[1,28]<-omega3
  param[1,29]<-phiu
  param[1,30]<-phipi
  param[1,31]<-psi_ad
  param[1,32]<-sigmaIB
  param[1,33]<-delta_k
  param[1,34]<-LTV
  param[1,35]<-h
  param[1,36]<-lev_ft1
  param[1,37]<-tau
  param[1,38]<-pit
  param[1,39]<-CARt0
  param[1,40]<-LCRt
  param[1,41]<-g0
  param[1,42]<-r0
  param[1,43]<-r1
  param[1,44]<-E_f
  param[1,45]<-randdis
  param[1,46]<-randdef
  param[1,47]<-sdev_dis
  param[1,48]<-sdev_def
  param[1,49]<-AR_dis
  param[1,50]<-iota1
  param[1,51]<-iota2
  param[1,52]<-sdev_R
  param[1,53]<-CBnoise
  param[1,54]<-AR_def
  param[1,55]<-gby
  param[1,56]<-AR_r
  param[1,57]<-Hommes
  param[1,58]<-psi_tf1
  param[1,59]<-psi_tf2
  param[1,60]<-psi_aa
  param[1,61]<-memory
  param[1,62]<-intensity
  param[1,63]<-epsilond2
  param[1,64]<-M_step
  param[1,65]<-LL_step
  param[1,66]<-W_n
  param[1,67]<-gamma1
  param[1,68]<-gamma2
  param[1,69]<-CC_def
  param[1,70]<-est1
  param[1,71]<-est2
  return(list(init=init,param=param,bankinit=bankinit))
} 
